---
layout: default
---

<section class="landing-page ob-progetti-landing {% if page.subsection == 'wAw' %}waw-project{% endif %}">
    <div class="container">
        <!-- HEADER -->
        <header class="landing-header">
            <h1 class="landing-title">{{ page.title }}</h1>
            {% if page.subtitle %}
            <p class="landing-description">{{ page.subtitle }}</p>
            {% endif %}
        </header>

        <!-- INTRO CONTENT (markdown da index.html) -->
        {% if content and content != "" and content != blank %}
        <div class="landing-content">
            {{ content }}
        </div>
        {% endif %}

        <!-- PROGETTI GRID (auto-generato) -->
        {% if page.subsection %}
            <!-- Siamo su una landing di progetto (es. /ob-progetti/waw/) -->
            <!-- Mostra solo le subsection di questo progetto specifico -->
            {% assign current_project_base = page.url | remove: '/index.html' | remove: '.html' %}
            {% assign all_progetti = site.pages | where: "section", "OB-Progetti" | where_exp: "item", "item.subsection == page.subsection" | where_exp: "item", "item.url != page.url" | where_exp: "item", "item.url contains current_project_base" | where_exp: "item", "item.layout != 'ob_session'" %}
            {% assign progetti = '' | split: '' %}
            {% for item in all_progetti %}
                {% unless item.url contains '/council/' %}
                    {% assign progetti = progetti | push: item %}
                {% endunless %}
            {% endfor %}
            {% assign progetti = progetti | sort: "order" %}
        {% else %}
            <!-- Siamo sulla landing principale (/ob-progetti/) -->
            <!-- Mostra solo i progetti principali (landing di progetto, non subsection) -->
            {% assign all_with_subsection = site.pages | where: "section", "OB-Progetti" | where_exp: "item", "item.subsection != nil" %}
            {% assign progetti = '' | split: '' %}
        {% endif %}
        
        {% if page.subsection %}
            <!-- Siamo su una landing di progetto: mostra subsection -->
            {% if progetti.size > 0 %}
            <div class="projects-grid">
                {% for progetto in progetti %}
                {% assign project = progetto %}
                {% include project-card.html %}
                {% endfor %}
            </div>
            {% endif %}
        {% else %}
            <!-- Siamo sulla landing principale: mostra progetti principali -->
            <div class="projects-grid">
                {% for item in all_with_subsection %}
                    {% assign subsection_slug = item.subsection | downcase | replace: ' ', '-' %}
                    {% assign expected_url = '/ob-progetti/' | append: subsection_slug | append: '/' %}
                    {% assign item_url_clean = item.url | remove: '/index.html' | remove: '.html' %}
                    {% if item_url_clean == expected_url %}
                    {% assign project = item %}
                    {% include project-card.html %}
                    {% endif %}
                {% endfor %}
            </div>
        {% endif %}

        <!-- FOOTER SECTION (se presente nel frontmatter) -->
        {% if page.show_footer %}
        <footer class="landing-footer">
            <p><strong>ç„¡</strong></p>
            <p class="footer-note">{{ page.footer_text | default: "OB-Progetti - Laboratorio Sperimentale Human-AI dal 2026" }}</p>
        </footer>
        {% endif %}
    </div>
</section>
